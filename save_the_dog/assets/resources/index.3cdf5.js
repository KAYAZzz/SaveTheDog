window.__require=function t(e,r,a){function i(s,l){if(!r[s]){if(!e[s]){var c=s.split("/");if(c=c[c.length-1],!e[c]){var u="function"==typeof __require&&__require;if(!l&&u)return u(c,!0);if(n)return n(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var o=r[s]={exports:{}};e[s][0].call(o.exports,function(t){return i(e[s][1][t]||t)},o,o.exports,t,e,r,a)}return r[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<a.length;s++)i(a[s]);return i}({MultTextures:[function(t,e,r){"use strict";cc._RF.push(e,"9adc5aULtFMOZEhCtCp6XHg","MultTextures"),Object.defineProperty(r,"__esModule",{value:!0}),r.getMultMaterial=r.MultBatch2D=void 0;var a=t("./MultUtils");cc.Component.prototype.useMult=!1;var i={texture:null,defalut:new cc.Texture2D,getImpl:function(){return this.texture}};cc.gfx.Texture2D.prototype.texID=-1;var n=0,s=!1,l=[];r.MultBatch2D={nativeObj:null,enable:!1,parent:null,curID:0,incID:0,count:0,hash:0,reset:function(){this.count>0&&this.curID++,this.incID+=this.count,this.count=0},clear:function(){for(var t=l,e=0;e<t.length;e++){var r=t[e];r.destroy(),r.decRef()}l.length=0}};var c=function(){r.MultBatch2D.enable=!1,cc.resources.load("multTextures/Mult-material",cc.Material,function(t,e){if(!t){var i=cc.Material.getBuiltinMaterial("2d-sprite");i&&(r.MultBatch2D.hash=a.getMaterialHash(i),r.MultBatch2D.parent=e,r.MultBatch2D.enable=!0,e.addRef())}})};r.getMultMaterial=function(t){if(r.MultBatch2D.reset(),s=!1,!r.MultBatch2D.enable||!t||!t.isMultTextures)return t;if(!r.MultBatch2D.parent||!r.MultBatch2D.parent.isValid)return c(),t;var e=l[n++];if(!e||!e.isValid){e=new(0,cc.MaterialVariant)(r.MultBatch2D.parent),l[n-1]=e;for(var a=0;a<8;a++)e.setProperty("texture"+a,i.defalut);e.updateHash(r.MultBatch2D.hash),e.define("USE_TEXTURE",!0),e.isMultTextures=!0,e.cacheTextures=[-1],e.addRef()}return s=!0,e};var u=function(t,e){var r=t._assembler._renderData;if(!r)return!1;var a=0,i=r.vDatas[0];if(t.dataDirty){t.dataDirty=!1;for(var n=0,s=i.length;n<s;n+=5)a=~~(1e5*i[n+2]),i[n+2]=10*a+e}else if(t.texID!=e)for(n=0,s=i.length;n<s;n+=5)a=~~(.1*i[n+2]),i[n+2]=10*a+e;t.texID=e},o=function(t,e,a){if(s&&e){var n=e.effect.passes[0].getProperty("texture");n||(console.warn(t.node.name," texture lost !!!!!"),e.setProperty("texture",i.defalut),n=i.defalut);var l=r.MultBatch2D,c=(e.effect,n.texID-l.incID);if(c<0){l.count>=8&&(a._flush(),a.material=r.getMultMaterial(e),a.node=e.getDefine("CC_USE_MODEL")?t.node:a._dummyNode),c=l.count++,n.texID=c+l.incID;var o=a.material,f=o.cacheTextures;f[c]!==n._id&&(f[c]=n._id,i.texture=n,o.setProperty("texture"+c,i),o.effect._dirty=!1,o._dirty=!1)}u(t,c)}},f=function(){if(cc.MotionStreak){var t=cc.MotionStreak.prototype,e=t.lateUpdate;t.useMult=!0,t.lateUpdate=function(t){e.call(this,t),this._assembler&&this._points.length>=2&&(this.dataDirty=!0)}}},h=function(){var t=cc.RenderComponent.prototype;t.texID=-1,t.vDitry=!0,t.dataDirty=!0,Object.defineProperty(t,"_vertsDirty",{get:function(){return this.vDitry},set:function(t){!t&&this.vDitry&&(this.dataDirty=!0),this.vDitry=t}});var e=t.setMaterial;t.setMaterial=function(t,r){var a=e.call(this,t,r);return this.setVertsDirty(),a};var i=cc.Material.prototype,s=i.getHash;i.getHash=function(){var t=this._effect;if(r.MultBatch2D.enable&&t&&t._dirty){this.isMultTextures=!1;var e=this._owner;if(e&&!e.node.is3DNode){var i=e instanceof cc.Label,n=e instanceof cc.Sprite;if(e.useMult||n||i&&!e._nativeTTF()){var l=a.getMaterialHash(this);if(l==r.MultBatch2D.hash)return this.isMultTextures=!0,t._dirty=!1,t._hash=l,l}}}return s.call(this)},t._checkBacth=function(t,e){var a=this._materials[0];(a&&a.getHash()!==t.material.getHash()||t.cullingMask!==e)&&(t._flush(),t.node=a.getDefine("CC_USE_MODEL")?this.node:t._dummyNode,t.material=r.getMultMaterial(a),t.cullingMask=e),o(this,a,t)},cc.director.on(cc.Director.EVENT_BEFORE_DRAW,function(){n=0,r.MultBatch2D.reset(),r.MultBatch2D.curID=0})};cc.game.once(cc.game.EVENT_GAME_INITED,function(){var t=cc.ENGINE_VERSION.split(".");parseInt(t[2])<3||parseInt(t[1])<4||parseInt(t[0])<2||(c(),f(),h())}),cc._RF.pop()},{"./MultUtils":"MultUtils"}],MultUtils:[function(t,e,r){"use strict";cc._RF.push(e,"4cc4f2NmTJMGaluoWmweHIF","MultUtils"),Object.defineProperty(r,"__esModule",{value:!0}),r.getMaterialHash=r.murmurhash2=r.serializeUniforms=r.serializePasses=r.serializePass=r.serializeDefines=void 0;var a=[];function i(t,e){if(e){for(var r=e.length,i=0;i<r;i++){var n=e[i];a[i]=n+t[n]}a.length=r}else{for(var n in i=0,t)a[i++]=n+t[n];a.length=i}return a.join("")}function n(t,e){void 0===e&&(e=!1);var r=t._programName+t._cullMode;return t._blend&&(r+=t._blendEq+t._blendAlphaEq+t._blendSrc+t._blendDst+t._blendSrcAlpha+t._blendDstAlpha+t._blendColor),t._depthTest&&(r+=t._depthWrite+t._depthFunc),t._stencilTest&&(r+=t._stencilFuncFront+t._stencilRefFront+t._stencilMaskFront+t._stencilFailOpFront+t._stencilZFailOpFront+t._stencilZPassOpFront+t._stencilWriteMaskFront+t._stencilFuncBack+t._stencilRefBack+t._stencilMaskBack+t._stencilFailOpBack+t._stencilZFailOpBack+t._stencilZPassOpBack+t._stencilWriteMaskBack),r+=i(t._defines,t._defineNames),e||(r+=l(t._properties,t._propertyNames)),r}function s(t,e){void 0===e&&(e=!1);for(var r="",a=0;a<t.length;a++)r+=n(t[a],e);return r}function l(t,e){var r=0;if(e)for(var i=0,n=e.length;i<n;i++)(l=t[e[i]].value)&&null==l._id&&(a[r]=l.toString(),r++);else for(var s in t){var l;(l=t[s].value)&&null==l._id&&(a[r]=l.toString(),r++)}return a.length=r,a.join(";")}function c(t,e){for(var r,a=t.length,i=e^a,n=0;a>=4;)r=1540483477*(65535&(r=255&t.charCodeAt(n)|(255&t.charCodeAt(++n))<<8|(255&t.charCodeAt(++n))<<16|(255&t.charCodeAt(++n))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),a-=4,++n;switch(a){case 3:i^=(255&t.charCodeAt(n+2))<<16;case 2:i^=(255&t.charCodeAt(n+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(n)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}r.serializeDefines=i,r.serializePass=n,r.serializePasses=s,r.serializeUniforms=l,r.murmurhash2=c,r.getMaterialHash=function(t){var e="",r=t._effect;return r&&(e+=s(r.passes,!1)),c(e,666)},cc._RF.pop()},{}]},{},["MultTextures","MultUtils"]);